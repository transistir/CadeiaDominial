<div class="field-group">
    <h4>Informa√ß√µes do Documento</h4>
    
    {% if is_primeiro_lancamento %}
    <!-- Cart√≥rio da Matr√≠cula para Primeiro Lan√ßamento -->
    <div class="form-group cartorio-matricula-info">
        <label>Cart√≥rio da Matr√≠cula</label>
        <div class="cartorio-display">
            <span class="cartorio-nome">{{ cartorio_matricula_nome }}</span>
        </div>
        <input type="hidden" name="cartorio" id="cartorio" value="{{ cartorio_matricula.id }}">
        <input type="hidden" name="cartorio_nome" id="cartorio_nome" value="{{ cartorio_matricula_nome }}">
    </div>
    {% else %}
    <!-- Cart√≥rio da Origem para Lan√ßamentos Subsequentes -->
    <div class="form-group cartorio-origem-info">
        <label>Cart√≥rio da Origem</label>
        <div class="cartorio-display">
            <span class="cartorio-nome">{{ documento.cartorio.nome }}</span>
            <small class="form-text text-muted">
                <strong>üí° Dica:</strong> Este √© o cart√≥rio da origem do documento. 
                Para lan√ßamentos subsequentes, o cart√≥rio √© definido pela origem do documento.
            </small>
        </div>
        <input type="hidden" name="cartorio" id="cartorio" value="{{ documento.cartorio.id }}">
        <input type="hidden" name="cartorio_nome" id="cartorio_nome" value="{{ documento.cartorio.nome }}">
    </div>
    {% endif %}
    
    <div class="form-group">
        <label for="tipo_lancamento">Tipo de Lan√ßamento *</label>
        <select name="tipo_lancamento" id="tipo_lancamento" required>
            <option value="">Selecione o tipo...</option>
            {% for tipo in tipos_lancamento %}
            <option value="{{ tipo.id }}" data-tipo="{{ tipo.tipo }}"
                    {% if modo_edicao and lancamento.tipo.id == tipo.id %}selected{% elif form_data and form_data.tipo_lancamento == tipo.id|stringformat:"s" %}selected{% endif %}>
                {{ tipo.get_tipo_display }}
            </option>
            {% endfor %}
        </select>
    </div>

    <div class="form-group">
        <label for="numero_lancamento">N√∫mero do Lan√ßamento *</label>
        <div class="grid-2">
            <div class="numero-simples-field">
                <input type="text" name="numero_lancamento_simples" id="numero_lancamento_simples" 
                       placeholder="Ex: 1, 5, etc." style="width: 100%;"
                       value="{% if form_data %}{{ form_data.numero_lancamento_simples }}{% endif %}">
                <small>Digite apenas o n√∫mero</small>
            </div>
            <div>
                <input type="text" name="numero_lancamento" id="numero_lancamento" readonly
                       style="width: 100%; background-color: #f8f9fa;"
                       value="{% if modo_edicao %}{{ lancamento.numero_lancamento }}{% elif form_data %}{{ form_data.numero_lancamento }}{% endif %}"
                       placeholder="Sigla ser√° gerada automaticamente">
                <small>Sigla completa gerada</small>
            </div>
        </div>
        <div class="error-message">
            {% if form.errors.numero_lancamento %}
                {{ form.errors.numero_lancamento.0 }}
            {% endif %}
        </div>
        <input type="hidden" name="sigla_matricula" value="{{ documento.numero }}">
        <input type="hidden" name="documento_id" value="{{ documento.id }}">
    </div>

    <div class="grid-3">
        <div class="form-group">
            <label for="livro_documento">Livro do Documento *</label>
            <input type="text" name="livro_documento" id="livro_documento" required
                   value="{% if modo_edicao %}{{ lancamento.documento.livro }}{% elif form_data %}{{ form_data.livro_documento }}{% endif %}"
                   placeholder="Ex: 1, 2, A, etc.">
            <small class="form-text text-muted">Livro do documento atual (ser√° aplicado ao documento)</small>
        </div>
        
        <div class="form-group">
            <label for="folha_documento">Folha do Documento *</label>
            <input type="text" name="folha_documento" id="folha_documento" required
                   value="{% if modo_edicao %}{{ lancamento.documento.folha }}{% elif form_data %}{{ form_data.folha_documento }}{% endif %}"
                   placeholder="Ex: 1, 2, A, etc.">
            <small class="form-text text-muted">Folha do documento atual (ser√° aplicada ao documento)</small>
        </div>
        
        <div class="form-group">
            <label for="data">Data *</label>
            <input type="date" name="data" id="data" required
                   value="{% if modo_edicao %}{{ lancamento.data|date:'Y-m-d' }}{% elif form_data %}{{ form_data.data }}{% endif %}">
        </div>
    </div>
</div>

<!-- Se√ß√£o de Informa√ß√µes de Origem (apenas para in√≠cio de matr√≠cula) -->
{% if not is_primeiro_lancamento %}
<div class="field-group" id="informacoes-origem">
    <h4>Informa√ß√µes de Origem</h4>
    <small class="form-text text-muted">
        <strong>üí° Dica:</strong> Estas informa√ß√µes s√£o sobre outros documentos que originaram este lan√ßamento.
        Elas s√£o diferentes dos campos "Livro/Folha do Documento" acima.
    </small>
    
    <div class="grid-3">
        <div class="form-group">
            <label for="livro_origem">Livro da Origem</label>
            <input type="text" name="livro_origem" id="livro_origem"
                   value="{% if modo_edicao %}{{ lancamento.livro_origem }}{% elif form_data %}{{ form_data.livro_origem }}{% endif %}"
                   placeholder="Ex: 1, 2, A, etc.">
            <small class="form-text text-muted">Livro do documento de origem</small>
        </div>
        
        <div class="form-group">
            <label for="folha_origem">Folha da Origem</label>
            <input type="text" name="folha_origem" id="folha_origem"
                   value="{% if modo_edicao %}{{ lancamento.folha_origem }}{% elif form_data %}{{ form_data.folha_origem }}{% endif %}"
                   placeholder="Ex: 1, 2, A, etc.">
            <small class="form-text text-muted">Folha do documento de origem</small>
        </div>
        
        <div class="form-group">
            <label for="data_origem">Data da Origem</label>
            <input type="date" name="data_origem" id="data_origem"
                   value="{% if modo_edicao and lancamento.data_origem %}{{ lancamento.data_origem|date:'Y-m-d' }}{% elif form_data %}{{ form_data.data_origem }}{% endif %}">
            <small class="form-text text-muted">Data do documento de origem</small>
        </div>
    </div>
</div>
{% endif %} 