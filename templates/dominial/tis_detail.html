{% extends "base.html" %}
{% load i18n static %}

{% block title %}{{ tis.nome }} - Imóveis{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'dominial/css/tis_detail.css' %}">
{% endblock %}

{% block content %}
<div class="tis-detail-container">
    <div class="tis-header">
        <h1>{{ tis.nome }}</h1>
        
        <div class="tis-info-grid">
            <div class="tis-info-card">
                <strong>{% trans 'Código' %}</strong>
                <span>{{ tis.codigo }}</span>
            </div>
            
            <div class="tis-info-card">
                <strong>{% trans 'Etnia' %}</strong>
                <span>{{ tis.etnia }}</span>
            </div>
            
            {% if tis.terra_referencia %}
            <div class="tis-info-card">
                <strong>{% trans 'Estado' %}</strong>
                <span>{{ tis.terra_referencia.estado }}</span>
            </div>
            
            <div class="tis-info-card">
                <strong>{% trans 'Fase' %}</strong>
                <span>{{ tis.terra_referencia.fase }}</span>
            </div>
            
            {% if tis.terra_referencia.area_ha %}
            <div class="tis-info-card">
                <strong>{% trans 'Área' %}</strong>
                <span>{{ tis.terra_referencia.area_ha|floatformat:0 }} ha</span>
            </div>
            {% endif %}
            {% endif %}
        </div>
    </div>

    <h2 class="section-title">{% trans 'Imóveis' %}</h2>
    
    <div class="imoveis-grid">
        {% for imovel in imoveis %}
        <div class="imovel-card" onclick="window.location.href='{% url 'cadeia_dominial' tis_id=tis.id imovel_id=imovel.id %}'">
            <div class="imovel-actions">
                <a href="{% url 'imovel_editar' tis_id=tis.id imovel_id=imovel.id %}" class="action-button edit-button">{% trans 'Editar' %}</a>
                <a href="{% url 'imovel_excluir' tis_id=tis.id imovel_id=imovel.id %}" class="action-button delete-button" onclick="event.stopPropagation(); return confirm('{% trans 'Tem certeza que deseja excluir este imóvel?' %}')">{% trans 'Excluir' %}</a>
            </div>
            
            <div class="imovel-header">
                <h3 class="imovel-title">{{ imovel.nome }}</h3>
            </div>
            
            <div class="imovel-info">
                <div class="imovel-info-item">
                    <span class="imovel-info-label">{% trans 'Matrícula' %}</span>
                    <span class="imovel-info-value">{{ imovel.matricula|default:"Não informada" }}</span>
                </div>
                
                <div class="imovel-info-item">
                    <span class="imovel-info-label">{% trans 'SNCR' %}</span>
                    <span class="imovel-info-value">{{ imovel.sncr|default:"Não informado" }}</span>
                </div>
                
                <div class="imovel-info-item">
                    <span class="imovel-info-label">{% trans 'SIGEF' %}</span>
                    <span class="imovel-info-value">{{ imovel.sigef|default:"Não informado" }}</span>
                </div>
                
                {% if imovel.proprietario %}
                <div class="imovel-info-item">
                    <span class="imovel-info-label">{% trans 'Proprietário' %}</span>
                    <span class="imovel-info-value">{{ imovel.proprietario.nome }}</span>
                </div>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <div class="empty-state">
            <div class="empty-state-icon">🏠</div>
            <p>{% trans 'Nenhum imóvel cadastrado nesta Terra Indígena.' %}</p>
        </div>
        {% endfor %}
    </div>

    <div style="text-align: center;">
        <a href="{% url 'imovel_cadastro' tis_id=tis.id %}" class="add-imovel-button">{% trans 'Cadastrar Novo Imóvel' %}</a>
    </div>
</div>
{% endblock %}
